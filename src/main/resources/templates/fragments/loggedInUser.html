<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <title>Logged In User</title>
</head>
<body>
<th:block th:fragment="loggedInUserFragment" sec:authorize="isAuthenticated()">
    <a href="#" class="text-black text-decoration-none small d-flex align-items-center"
       id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <th:block th:if="${currentUser != null and currentUser.imageUrl != null}">
            <img th:src="@{${currentUser.imageUrl}}" alt="User Image"
                 style="width: 32px; height: 32px; border-radius: 50%; object-fit: cover;"
                 class="border border-secondary rounded-circle"/>
        </th:block>
        <th:block th:unless="${currentUser != null and currentUser.imageUrl != null}">
            <i class="bi bi-person-circle d-inline-flex align-items-center justify-content-center"
               style="width: 32px; height: 32px; font-size: 32px;"></i>
        </th:block>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
        <li>
            <a class="dropdown-item text-muted fw-normal" th:href="@{/profile}">
                <i class="bi bi-person me-3"></i>Profile
            </a>
        </li>
        <li>
            <a class="dropdown-item text-muted fw-normal" th:href="@{/posts/new}">
                <i class="bi bi-pencil-square me-3"></i>Write
            </a>
        </li>
        <li>
            <a class="dropdown-item text-muted fw-normal" th:href="@{/posts/saved-post}">
                <i class="bi bi-bookmarks me-3"></i>Library
            </a>
        </li>
        <li>
            <a class="dropdown-item text-muted fw-normal" th:href="@{/posts/my-blog}">
                <i class="bi bi-journal-text me-3"></i>Stories
            </a>
        </li>
        <li>
            <hr class="dropdown-divider">
        </li>
        <li>
            <form th:action="@{/logout}" method="post" class="d-inline">
                <button class="dropdown-item text-muted fw-normal" id="logoutBtn">
                    <i class="bi bi-box-arrow-right me-3"></i>Sign out
<!--                    <p class="text-muted mt-1 mb-0" style="font-size: 0.6rem" th:text="${currentUser.username}"></p>-->
                </button>
            </form>
        </li>
    </ul>
</th:block>
</body>
</html>